{
	"info": {
		"_postman_id": "957a8bc7-84ec-4a16-a983-ce89264e7875",
		"name": "OARS",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Keycloak",
			"item": [
				{
					"name": "Get All Clients",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "04d281c4-786d-4260-b739-5b1501043f16",
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"realm\": \"oars\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/clients",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"clients"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get OARS Client - Set client_id Env Var",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "d92838a0-21cb-48ba-a4de-1a8c3b12c935",
								"exec": [
									"let response = pm.response.json()",
									"",
									"for (var i = 0; i < response.length; i++){",
									"  if (response[i].clientId == \"oars-client\"){",
									"    pm.environment.set(\"client_id\", response[i].id);",
									"  }",
									"}",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/clients",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"clients"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Users",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"firstName\": \"user\",\n    \"lastName\": \"automatic\",\n    \"email\": \"testing@test.com\",\n    \"enabled\": \"true\",\n    \"username\": \"app-user\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/users",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get User-Role Mapping",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/users/1c8d7c5a-c212-4be3-999a-f377ef720643/role-mappings/clients/{{client_id}}",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"users",
								"1c8d7c5a-c212-4be3-999a-f377ef720643",
								"role-mappings",
								"clients",
								"{{client_id}}"
							],
							"query": [
								{
									"key": "",
									"value": null,
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Client Roles",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/clients/{{client_id}}/roles",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"clients",
								"{{client_id}}",
								"roles"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create User",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "99aed70c-d4ee-463b-8fab-ba5672dcc6bd",
								"exec": [
									"var entity = data.entity;",
									"var firstName = data.firstName;",
									"var lastName = data.lastName;",
									"var group = data.group;",
									"var country_code = data.country_code;",
									"var password = data.password;",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "760bae53-48bd-4d21-b5b2-2e5c7db3eb57",
								"exec": [
									"var location = pm.response.headers.get(\"Location\")",
									"var user_id = location.substr(location.lastIndexOf('/') + 1);",
									"pm.environment.set(\"last_created_user_id\", user_id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"firstName\": \"{{firstName}}\",\n    \"lastName\": \"{{lastName}}\",\n    \"email\": \"{{firstName}}.{{lastName}}@{{entity}}.com\",\n    \"enabled\": \"true\",\n    \"username\": \"{{firstName}}.{{lastName}}\",\n    \"groups\": [\n        \"{{group}}\"\n    ],\n    \"attributes\": {\n        \"country\": [\n            \"{{country_code}}\"\n        ],\n        \"avatar\": [\n            \"{{firstName}}.{{lastName}}.jpg\"\n        ]\n    },\n    \"credentials\": [\n        {\n            \"type\": \"password\",\n            \"value\": \"{{password}}\"\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/users",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create User-Role Mapping - Funds_Issuer",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "c4a187cc-d772-4457-8642-47b252aad2c6",
								"exec": [
									"var user_id = pm.environment.get(\"last_created_user_id\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "[\n    {\n        \"id\": \"10623f53-55b0-4865-a4bc-22fee85b1222\",\n        \"name\": \"funds_issuer\",\n        \"composite\": false,\n        \"clientRole\": true,\n        \"containerId\": \"0647784f-5286-42b7-8dde-c5122448ea80\"\n    }\n]",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/users/{{last_created_user_id}}/role-mappings/clients/{{client_id}}",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"users",
								"{{last_created_user_id}}",
								"role-mappings",
								"clients",
								"{{client_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create User-Role Mapping - Funds_Receiver",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "ff1d3e1c-1771-409c-9d67-b4311f50be5a",
								"exec": [
									"var user_id = pm.environment.get(\"last_created_user_id\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "[\n    {\n        \"id\": \"ad9c78d9-e9ff-4990-9f2b-2d53876aea8d\",\n        \"name\": \"funds_receiver\",\n        \"composite\": false,\n        \"clientRole\": true,\n        \"containerId\": \"0647784f-5286-42b7-8dde-c5122448ea80\"\n    }\n]",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/users/{{last_created_user_id}}/role-mappings/clients/{{client_id}}",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"users",
								"{{last_created_user_id}}",
								"role-mappings",
								"clients",
								"{{client_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create User-Role Mapping - Funds_Requestor",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "45a84f29-b669-49fd-bf6e-b50904ddf65a",
								"exec": [
									"var user_id = pm.environment.get(\"last_created_user_id\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "[\n    {\n        \"id\": \"6e13dbcd-dd7c-427c-8846-44989b68c4ae\",\n        \"name\": \"funds_requestor\",\n        \"composite\": false,\n        \"clientRole\": true,\n        \"containerId\": \"0647784f-5286-42b7-8dde-c5122448ea80\"\n    }\n]",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/users/{{last_created_user_id}}/role-mappings/clients/{{client_id}}",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"users",
								"{{last_created_user_id}}",
								"role-mappings",
								"clients",
								"{{client_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create User-Role Mapping - Request_Approver",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "c3c46e19-f5c3-4bdd-80dc-099f12e6f3df",
								"exec": [
									"var user_id = pm.environment.get(\"last_created_user_id\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "[\n    {\n        \"id\": \"99f41295-815d-4af6-bf5b-906638e1a354\",\n        \"name\": \"request_approver\",\n        \"composite\": false,\n        \"clientRole\": true,\n        \"containerId\": \"0647784f-5286-42b7-8dde-c5122448ea80\"\n    }\n]",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}/auth/admin/realms/oars/users/{{last_created_user_id}}/role-mappings/clients/{{client_id}}",
							"host": [
								"{{server}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"oars",
								"users",
								"{{last_created_user_id}}",
								"role-mappings",
								"clients",
								"{{client_id}}"
							]
						}
					},
					"response": []
				}
			],
			"auth": {
				"type": "bearer",
				"bearer": [
					{
						"key": "token",
						"value": "{{token}}",
						"type": "string"
					}
				]
			},
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "e6ed316e-b800-4ea0-a910-1ffd73656eed",
						"type": "text/javascript",
						"exec": [
							"var server       = pm.environment.get(\"server\");",
							"var realm        = \"oars\";",
							"var grantType    = \"client_credentials\";",
							"var clientId     = \"oars-client\";",
							"var clientSecret = pm.environment.get(\"client_secret\");",
							"",
							"var url  = `${server}/auth/realms/${realm}/protocol/openid-connect/token`;",
							"var data = `grant_type=${grantType}&client_id=${clientId}&client_secret=${clientSecret}`;",
							"",
							"pm.sendRequest({",
							"    url: url,",
							"    method: 'POST',",
							"    header: { 'Content-Type': 'application/x-www-form-urlencoded'},",
							"    body: {",
							"        mode: 'raw',",
							"        raw: data",
							"    }",
							"},  function(err, response) {",
							"    ",
							"    var response_json = response.json();",
							"    var token = response_json.access_token;",
							"    pm.environment.set('token', token);",
							"});"
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "cac4d807-00a9-409c-bdde-d0a236b54808",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "Funds",
			"item": [
				{
					"name": "Get Funds",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{server}}:{{usdoj_port}}/api/funds",
							"host": [
								"{{server}}"
							],
							"port": "{{usdoj_port}}",
							"path": [
								"api",
								"funds"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Fund by ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{server}}:{{usdoj_port}}/api/fund/id?fundId=5662fd77-3efd-4e54-8d39-ac8448ec93d9",
							"host": [
								"{{server}}"
							],
							"port": "{{usdoj_port}}",
							"path": [
								"api",
								"fund",
								"id"
							],
							"query": [
								{
									"key": "fundId",
									"value": "5662fd77-3efd-4e54-8d39-ac8448ec93d9"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Fund by Status",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{server}}:{{usdoj_port}}/api/fund/status?status=RECEIVED",
							"host": [
								"{{server}}"
							],
							"port": "{{usdoj_port}}",
							"path": [
								"api",
								"fund",
								"status"
							],
							"query": [
								{
									"key": "status",
									"value": "RECEIVED"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Fund State",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"originParty\": \"O=US_DoJ,L=New York,C=US\",\n    \"receivingParty\": \"O=Catan_Treasury, L=London, C=GB\",\n    \"amount\": \"10000000\",\n    \"maxWithdrawalAmount\": \"10000000\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}:{{usdoj_port}}/api/fund",
							"host": [
								"{{server}}"
							],
							"port": "{{usdoj_port}}",
							"path": [
								"api",
								"fund"
							]
						}
					},
					"response": []
				},
				{
					"name": "Receive Fund State",
					"request": {
						"method": "PUT",
						"header": [],
						"url": {
							"raw": "{{server}}:{{catantreasury_port}}/api/fund?fundId=477cfc01-012b-4a92-9432-250b6450d1ec",
							"host": [
								"{{server}}"
							],
							"port": "{{catantreasury_port}}",
							"path": [
								"api",
								"fund"
							],
							"query": [
								{
									"key": "fundId",
									"value": "477cfc01-012b-4a92-9432-250b6450d1ec"
								}
							]
						}
					},
					"response": []
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "Requests",
			"item": [
				{
					"name": "Create Request State",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"amount\": \"10000\",\n  \"authorizedUserDept\": \"Catan Ministry of Education\",\n  \"authorizedUserUsername\": \"Jen Stevens\",\n  \"externalAccountId\": \"TESTACC\",\n  \"fundStateLinearId\": \"0f9b9ca8-ef57-4704-892c-509d50838192\",\n  \"purpose\": \"TEST\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{server}}:{{catanmofa_port}}/api/request",
							"host": [
								"{{server}}"
							],
							"port": "{{catanmofa_port}}",
							"path": [
								"api",
								"request"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Requests",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:10050/api/requests",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "10050",
							"path": [
								"api",
								"requests"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Request by ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:10050/api/request/id?requestId=d1c8cf74-70da-4b41-9405-fe9bbf6ee150",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "10050",
							"path": [
								"api",
								"request",
								"id"
							],
							"query": [
								{
									"key": "requestId",
									"value": "d1c8cf74-70da-4b41-9405-fe9bbf6ee150"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Request by Status",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:10050/api/request/status?status=PENDING",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "10050",
							"path": [
								"api",
								"request",
								"status"
							],
							"query": [
								{
									"key": "status",
									"value": "PENDING"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Approve Request State",
					"request": {
						"method": "PUT",
						"header": [],
						"url": {
							"raw": "{{server}}:{{catanmoj_port}}/api/request?requestStateLinearId=a890adc2-a8bc-49aa-b901-909c7051e58b&authorizerUserUsername=Doug Yu&authorizerUserDept=Catan Ministry of Justice",
							"host": [
								"{{server}}"
							],
							"port": "{{catanmoj_port}}",
							"path": [
								"api",
								"request"
							],
							"query": [
								{
									"key": "requestStateLinearId",
									"value": "a890adc2-a8bc-49aa-b901-909c7051e58b"
								},
								{
									"key": "authorizerUserUsername",
									"value": "Doug Yu"
								},
								{
									"key": "authorizerUserDept",
									"value": "Catan Ministry of Justice"
								}
							]
						}
					},
					"response": []
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "Transfers",
			"item": [
				{
					"name": "Get Transfers",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{server}}:{{catantreasury_port}}/api/transfers",
							"host": [
								"{{server}}"
							],
							"port": "{{catantreasury_port}}",
							"path": [
								"api",
								"transfers"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Transfer",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{server}}:{{catantreasury_port}}/api/transfer?requestId",
							"host": [
								"{{server}}"
							],
							"port": "{{catantreasury_port}}",
							"path": [
								"api",
								"transfer"
							],
							"query": [
								{
									"key": "requestId",
									"value": null
								}
							]
						}
					},
					"response": []
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "178833e7-2d8b-4b5a-a9a2-7f9ebc6f5ac8",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "d0d0ff08-da9a-4c4a-8e84-7fc9425fa232",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"protocolProfileBehavior": {}
}